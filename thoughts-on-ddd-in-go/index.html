<!doctype html><html lang=en-us>
<head>
<title>Thoughts on DDD in Go | Marcus Olsson</title>
<link rel=stylesheet href=/scss/main.60267226752bba5eb0a967ce8ee5f75af9a7eb73e06033e474056916ea4dfa49cc907c4461a7958ef48d19669280ba7eb1b6bbee32c1fd12f35e6b9089f3a842.css integrity="sha512-YCZyJnUrul6wqWfOjuX3Wvmn63PgYDPkdAVpFupN+knMkHxEYaeVjvSNGWaSgLp+sba77jLB/RLzXmuQifOoQg==">
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=author content="Marcus Olsson">
<meta name=description content="When I set out to port the DDD sample application to Go, I had done a couple of minor projects in Go on my spare time. The experience I had got from those projects had been refreshing, to say the least. I felt like I was being more productive than I had ever been in other object-oriented programming languages. But then I got curious.">
<meta name=twitter:card content="summary">
<meta name=og:type content="article">
<meta name=og:title content="Thoughts on DDD in Go | Marcus Olsson">
<meta name=og:description content="When I set out to port the DDD sample application to Go, I had done a couple of minor projects in Go on my spare time. The experience I had got from those projects had been refreshing, to say the least. I felt like I was being more productive than I had ever been in other object-oriented programming languages. But then I got curious.">
<meta name=og:url content="https://marcus.se.net/thoughts-on-ddd-in-go/">
<meta name=og:image content="https://marcus.se.net/images/avatar_hu79b10322fccaa7c63e12808baa2d9ea4_209492_512x512_resize_box_3.png">
<link rel=icon sizes=32x32 type=image/png href=/images/avatar_hu79b10322fccaa7c63e12808baa2d9ea4_209492_32x32_resize_box_3.png>
<link rel=apple-touch-icon sizes=180x180 type=image/png href=/images/avatar_hu79b10322fccaa7c63e12808baa2d9ea4_209492_180x180_resize_box_3.png>
<link rel=“canonical” href=https://marcus.se.net/thoughts-on-ddd-in-go/>
<link rel=prefetch href=/>
<link rel=prefetch href=/writing/>
<link rel=prefetch href=/speaking/>
<link rel=prefetch href=/projects/>
<script defer data-domain=marcus.se.net src=https://plausible.io/js/plausible.js></script>
</head>
<body>
<a class=skip-link href=#main>Skip to content</a><header class=header>
<div class=brand>
<div class=brand__title>Marcus Olsson</div>
<div class=brand__subtitle>Software Creative and Educator</div>
</div>
<nav class=nav>
<a class=nav__link href=/>Home</a>
<a class=nav__link href=/writing>Writing</a>
<a class=nav__link href=/speaking>Speaking</a>
<a class=nav__link href=/projects>Projects</a>
</nav>
</header>
<div class=container>
<main id=main>
<article class=text-block>
<header class=section__header>
<h1>Thoughts on DDD in Go</h1><time datetime=2014-10-10 class=publication-date>Oct 10, 2014</time></header>
<section>
<p>When I set out to port the DDD sample application to Go, I had done a couple of minor projects in Go on my spare time. The experience I had got from those projects had been refreshing, to say the least. I felt like I was being more productive than I had ever been in other object-oriented programming languages. But then I got curious.</p>
<p>Given the simple yet expressive syntax of Go, it should allow me to really focus on expressing the business logic, the ubiquitous language of a domain. Inspired by Paul Rayner&rsquo;s work on porting the <a href=https://github.com/paulrayner/ddd_sample_app_ruby>DDD Sample App to Ruby</a>, I felt compelled to start working on my own port of the application, using the Go programming language.</p>
<p>Since Go is still object-oriented in a minimal sort of way, it was fairly easy to just rewrite all the Java classes to Go. In a relatively short amount of time, I had the basic use cases such as booking a cargo, assigning it to a route and making sure it had a valid state. Somewhere along the way though, something started bothering me. I started feeling that I was forcing a design upon the code that had made sense in Java, but felt contrived, or even bloated, when written in Go. I focused on how I would implement the building blocks of DDD such as Value Objects and Entities, but the <code>SameValue()</code> and <code>SameIdentity()</code> methods were really starting to pollute my packages. Finally, I decided to remove them all, and it was about then I started realizing that the code had become so lean and mean, that each line that did not express the language of the domain, felt superfluous. It felt like I had removed a lot of unnecessary syntax while keeping the domain logic intact and possibly making it even clearer without all the clutter. But it still did not feel like I was anywhere near a idiomatic port.</p>
<p>When organizing the code according to the Clean Architecture, or Hexagonal Architecture, as the original sample application had, I was getting packages containing only a few lines of code. I liked the idea of having pure domain packages so that if I would <a href=http://blog.golang.org/organizing-go-code>go get</a> one of them, it would come, preferably, completely without any dependencies except other domain packages. The result then was, because tasks like setting up a REST API or persisting domain objects to MongoDB requires so little code, the remaining packages would contain one file with just a few lines of code. Furthermore, the reusability of those packages would be close to none. A Q&A session on the recent dotGoEu conference caught my attention when the <a href=http://dotgo.sourcegraph.com/post/99652344343/go-team-q-a-dependency-management-language-design>following question</a> came up:</p>
<blockquote>
<p><strong>Q: Antipatterns arise in every language, especially new ones as people find what features can be used and reused. What antipatterns do you see, and what are the better patterns?</strong></p>
</blockquote>
<blockquote>
<p><em>Dave Cheney:</em> Too many packages. Packages should be at the granularity of an idea. HTTP is an idea; an HTTP client is not an idea.</p>
</blockquote>
<p>Cheney&rsquo;s answer resonated with the thoughts I had been having. Cargo is an idea but a MongoDB implementation of a cargo repository is not. One could argue that &ldquo;infrastructure&rdquo; is an idea, but I would say it is too vague, too general. But where else would I put it?</p>
<p>By now, the progress on my port had grinded to a halt. So I decided I would ask Rinat Abdullin, who has been doing DDD with Go on his current project, a swedish dating site, about what thoughts they were having. His <a href=https://gist.github.com/abdullin/3e3fd199674255e4d206>answer</a> was more comprehensive than I could have hoped for, and I highly recommend reading it. Basically, he and his team went for the decision to include the implementation details into the package and exposing the behaviour through a REST API, making each package <em>at the granularity of an idea</em>, with a clear focus on communicating using domain events.</p>
<p>Indeed, their design is much different from the design of the original DDD sample application (as well as my port). When doing a port like this, I believe that it should not just be about changing syntax, but also adhering to the design principles of the programming language you are porting it to. As such, I am currently trying to decide on where to go from here. Either I accept that it was indeed a great learning experience and acknowledge that the original design just is not the Go way. Or, I start refactoring towards a completely new, more idiomatic, design. I would love to hear your thoughts!</p>
</section>
</article>
</main><footer class="footer text-block">
<p class="overline text--disabled">About</p>
<p class=text--disabled>
I'm a Developer Advocate at
<a href=https://grafana.com>Grafana Labs</a>, who enjoys learning,
building, and teaching software.
</p>
<div class=social>
<a class=social__icon href=https://github.com/marcusolsson aria-label=GitHub><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub icon</title><path d="M12 .297c-6.63.0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577.0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93.0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176.0.0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22.0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22.0 1.606-.015 2.896-.015 3.286.0.315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg>
</a>
<a class=social__icon href=https://twitter.com/marcusolsson aria-label=Twitter><svg role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><title>Twitter icon</title><path d="M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958.0 002.163-2.723c-.951.555-2.005.959-3.127 1.184A4.92 4.92.0 0011.78 8.288C7.69 8.095 4.067 6.13 1.64 3.162A4.822 4.822.0 00.974 5.637c0 1.71.87 3.213 2.188 4.096A4.904 4.904.0 01.934 9.117v.06a4.923 4.923.0 003.946 4.827 4.996 4.996.0 01-2.212.085 4.936 4.936.0 004.604 3.417A9.867 9.867.0 011.17 19.611c-.39.0-.779-.023-1.17-.067a13.995 13.995.0 007.557 2.209c9.053.0 13.998-7.496 13.998-13.985.0-.21.0-.42-.015-.63A9.935 9.935.0 0024 4.59z"/></svg>
</a>
<a class=social__icon href=https://linkedin.com/in/marcusolsson1 aria-label=LinkedIn><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>LinkedIn icon</title><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853.0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601.0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144.0-2.063-.926-2.063-2.065.0-1.138.92-2.063 2.063-2.063 1.14.0 2.064.925 2.064 2.063.0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225.0H1.771C.792.0.0.774.0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2.0 22.222.0h.003z"/></svg>
</a>
</div>
<p class=text--disabled>
<small>&copy; Copyright 2021
<a href=https://marcus.se.net>Marcus Olsson</a></small>
</p>
</footer>
</div>
</body>
</html>